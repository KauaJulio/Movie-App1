<ion-header class="ion-no-border heroflex-header" [translucent]="true">
  <ion-toolbar>
    <ion-title class="heroflex-logo">
      <span class="heroflex-text">Pesquisar</span>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="search-content">
  <div class="search-container">
    <ion-searchbar
      [(ngModel)]="searchQuery"
      (ionChange)="onSearchChange($event)"
      placeholder="Buscar filmes, s√©ries..."
      class="search-bar"
    ></ion-searchbar>
  </div>

  @if (!hasSearched) {
    <div class="empty-search">
      <div class="search-icon">üîç</div>
      <h2>Busque por filmes e s√©ries</h2>
      <p>Digite o nome de um filme ou s√©rie para come√ßar</p>
    </div>
  } @else if (isSearching) {
    <div class="loading-container">
      <ion-spinner></ion-spinner>
      <p>Buscando...</p>
    </div>
  } @else if (searchResults.length === 0) {
    <div class="no-results">
      <div class="no-results-icon">üòï</div>
      <h2>Nenhum resultado encontrado</h2>
      <p>Tente buscar por outro termo</p>
    </div>
  } @else {
    <div class="search-results">
      <div class="results-header">
        <p>{{ searchResults.length }} resultado(s) encontrado(s)</p>
      </div>

      <div class="results-list">
        @for (item of searchResults; track item.id) {
          @if (isNotPerson(item)) {
            <div class="result-item" (click)="openMovieDetail(item)">
              <div class="result-poster">
                @if (item.poster_path) {
                  <img
                    [src]="'https://image.tmdb.org/t/p/w185' + item.poster_path"
                    [alt]="getItemTitle(item)"
                    class="poster-img"
                  />
                } @else {
                  <div class="poster-placeholder">
                    <ion-icon [name]="getMediaTypeIcon(item)"></ion-icon>
                  </div>
                }
              </div>

              <div class="result-info">
                <h3>{{ getItemTitle(item) }}</h3>
                <p class="result-type">{{ getMediaTypeLabel(item) }}</p>
                @if (item.vote_average > 0) {
                  <p class="result-rating">‚≠ê {{ item.vote_average.toFixed(1) }}/10</p>
                }
                <p class="result-description">
                  {{ (item.overview | slice: 0: 80) }}...
                </p>
              </div>

              <div class="result-action">
                <ion-button
                  size="small"
                  fill="clear"
                  (click)="toggleWatchlist(item, $event, getMediaType(item))"
                >
                  <ion-icon
                    [name]="isItemInWatchlist(item) ? 'heart' : 'heart-outline'"
                  ></ion-icon>
                </ion-button>
              </div>
            </div>
          }
        }
      </div>
    </div>
  }

  <div class="spacer"></div>
</ion-content>

